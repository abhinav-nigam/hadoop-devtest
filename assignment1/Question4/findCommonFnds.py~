#!/usr/bin/env python

import sys
import os
import math

class Mapper:
    def __init__(self):
        pass
    def __call__(self, key, value):
        tempArr = value.split('->')
        tempArr1 = tempArr[1].split(',')
	for x in tempArr1:
		combinationsTempArr = [tempArr[0],x]
		combinationsTempArr.sort()
		yield (combinationsTempArr.join(",").replace(' ','')), tempArr[1].replace((x+','),'').replace((','+x),'').replace(' ','')


def reducer(key, values):
    tempValArr = [temp for temp in values]
    yield key, tempValArr

if __name__ == "__main__":
    import dumbo
    dumbo.run(Mapper, reducer, combiner=None)
